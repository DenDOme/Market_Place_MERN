# API Gateway

## Описание

**API Gateway** – это центральная точка входа в систему микросервисов маркетплейса. Он маршрутизирует входящие HTTP-запросы к соответствующим сервисам, выполняет базовые проверки безопасности и контролирует частоту запросов, обеспечивая защиту и стабильную работу системы.

## Основные задачи

API Gateway выполняет ряд ключевых функций:

- **Маршрутизация запросов** – перенаправление API-запросов к нужным микросервисам.
- **Управление доступом** – реализация аутентификации и авторизации пользователей.
- **Защита системы** – предотвращение DDoS-атак за счёт ограничения частоты запросов.
- **Балансировка нагрузки** – равномерное распределение запросов между сервисами.
- **Логирование и обработка ошибок** – фиксация и обработка ошибок с возвратом корректных статусов ответов.

## Функциональные возможности

### 1. Маршрутизация API-запросов

- Перенаправляет запросы к сервисам **Authentication**, **Product**, **Order** и другим.
- Использует `redirectMiddleware` для корректной маршрутизации запросов.

### 2. Обеспечение безопасности

- Применяет `helmet` для защиты HTTP-заголовков.
- Использует `cors` для управления политикой кросс-доменных запросов.
- Реализует защиту от частых запросов с помощью `express-rate-limit`.

### 3. Аутентификация и авторизация

- Проверяет подлинность пользователей через middleware `authenticateUser`.
- Контролирует роли пользователей (`checkUserRole`), ограничивая доступ к определённым операциям.

### 4. Обработка ошибок и логирование

- Логирует ошибки и передаёт клиенту соответствующие ответы.
- Управляет статусами ответов и заголовками для улучшенной обработки API-запросов.

## Используемые технологии

- **Express.js** – фреймворк для создания REST API.
- **dotenv** – управление переменными окружения.
- **cors** – настройка политики безопасности кросс-доменных запросов.
- **helmet** – защита HTTP-заголовков.
- **express-rate-limit** – предотвращение DDoS-атак.
- **cookie-parser** – работа с куками.
- **axios** – выполнение HTTP-запросов к другим сервисам.

## Пример маршрутизации запроса

`http://${host}/api/${serverKey}/${remainingPath}`

- **host** – URL API Gateway.
- **serverKey** – уникальный ключ микросервиса, по которому API Gateway определяет, куда направить запрос.
- **remainingPath** – оставшаяся часть пути запроса.

## Заключение

API Gateway – это важнейший компонент системы, обеспечивающий централизованное управление запросами, безопасность и балансировку нагрузки. Его использование значительно упрощает взаимодействие клиентов с микросервисами, повышая надёжность, масштабируемость и безопасность всей системы.
